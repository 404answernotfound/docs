---
title: Squashing migration
metaDescription: How to squash multiple migrations (.sql files) into a single migration.
---

<TopBlock>

This topic describes how to squash multiple migrations (.sql files) into a single migration.

</TopBlock>

## About squashing migrations

There are two common use cases for squashing multiple migrations (.sql files) into a single migration.

### Migrate cleanly from a development environment

In a busy development environment, whether there is only one person or 20 on a team, after a large development effort you might want to push one single migrations.sql file to your production environment, and leave out some extraneous, unneeded migrations. This practices cleans up not only the developent environment,but also helps keep your productionenvironment's migrations history less cluttered.

Consider the following scenario:
Your team has a branch based workflow. A developer branches from `/main` and starts working on a feature branch. This includes generating multiple migrations using `migrate dev`. After the feature is finished, the migration history might contain unnecessary intermediate steps that are unwanted in the final migration history that will be pushed to `/main`. There could also be pressing reasons why the intermediate steps can not be applied in production (they might lose data or be extremely slow / disruptive). The user therefore wants to squash all their newly created local migrations into one migration, that does not include the undeeded, extraneous migrations. The squashed migration can then be applied to production with `npx prisma migrate deploy`.

For detailed instructions, refer to --anchor link to steps below--.

### Create a clean history in a production environment

The practice of using `migrate diff` is used to for minimize number of migration files in your production so that anyone pulling from production gets a clean package.

Consider the following scenario:
The productionenviroment has accumulated a longer migration history. Replaying it in new environments has become a burden due to intermediate steps requiring extra time. Since the team is not deriving value from the migration steps (and could get them back from git history in a pinch) the decision is made to squash the whole history into a single migration.

For detailed instructions, refer to --anchor link to steps below--.

## Important Considerations

<Admonition type="info">

- When squashing migrations, be aware that any custom SQL in your migration.sql files will not be retained.

</Admonition>

## Using migration squashing
